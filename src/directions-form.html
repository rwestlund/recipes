<!--
    Copyright (c) 2016-2018, Randy Westlund. All rights reserved.
    This code is under the BSD-2-Clause license.
-->
<!-- This module displays a directions editing form. -->

<link rel="import" href="../bc/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bc/iron-icon/iron-icon.html">
<link rel="import" href="../bc/iron-icons/iron-icons.html">
<link rel="import" href="../bc/paper-button/paper-button.html">
<link rel="import" href="../bc/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bc/paper-input/paper-textarea.html">
<link rel="import" href="../bc/polymer-responsive-dialog/responsive-dialog.html">
<link rel="import" href="../bc/polymer/lib/elements/dom-repeat.html">
<link rel="import" href="../bc/polymer/lib/mixins/gesture-event-listeners.html">
<link rel="import" href="../bc/polymer/polymer-element.html">

<link rel="import" href="form-mixin.html">

<dom-module id="directions-form">
<template>
    <style include="iron-flex iron-flex-alignment"></style>
    <responsive-dialog id="dialog"
               title="Edit Directions"
               dismiss-text="Cancel"
               confirm-text="Save"
               on-iron-overlay-closed="resolve_dialog">

            <template is="dom-repeat" items="{{recipe.directions}}">
                <paper-textarea type="text"
                        label="Step [[add_one(index)]]"
                        value="{{item}}"
                        autocapitalize="sentences"
                        char-counter maxlength="200">
                </paper-textarea>
                <div class="layout horizontal end-justified">
                    <paper-button on-tap="delete_direction">
                        <iron-icon icon="icons:cancel"></iron-icon>
                        Remove Step [[add_one(index)]]
                    </paper-button>
                    <paper-icon-button
                            icon="icons:arrow-upward"
                            disabled$="[[!index]]"
                            on-tap="move_direction_up">
                    </paper-icon-button>
                </div>
            </template>
            <div class="layout horizontal center-justified">
                <paper-button on-tap="add_direction">
                    <iron-icon icon="icons:add-circle"></iron-icon>
                    Add Step
                </paper-button>
            </div>
        </div>
    </responsive-dialog>
</template>

<script>
class DirectionsForm extends Polymer.GestureEventListeners(
        Recipes.FormMixin(Polymer.Element)) {
    static get is() { return  "directions-form"; }
    static get properties() {
        return {
            recipe: { type: Object },
        };
    }
    add_direction() {
        this.push("recipe.directions", new String());
        this.size_changed();
    }
    delete_direction(e) {
        this.splice("recipe.directions", e.model.index, 1);
        this.size_changed();
    }
    move_direction_up(e) {
        var temp = this.splice("recipe.directions", e.model.index, 1)[0];
        this.splice("recipe.directions", e.model.index - 1, 0, temp);
    }
    add_one(val) { return val + 1; }
}
customElements.define(DirectionsForm.is, DirectionsForm);
</script>
</dom-module>
