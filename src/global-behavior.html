<!--
    Copyright (c) 2016-2017, Randy Westlund. All rights reserved.
    This code is under the BSD-2-Clause license.
-->
<!-- This defines behavior and utilities imported by all element. -->

<script>
var constants = {};

constants.user_role_enum = {
    admin:      'Admin',
    moderator:  'Moderator',
    user:       'User',
    guest:      'Guest',
};

// Take an dictionary, return an array of values. This is defined outside the
// behavior so I can use it on constants.
var to_array = function(obj) {
    if (!obj) return [];
    return Object.keys(obj).map(k => obj[k]).sort();
};

// Provide presorted lists.
constants.user_roles = to_array(constants.user_role_enum);

var recipe_behaviors = recipe_behaviors || {};
/** @polymerBehavior recipe_behaviors.global_behavior */
recipe_behaviors.global_behavior = {
    properties: {
        constants: {
            type: Object,
            value: constants,
        },
    },
    is_admin: function(role) {
        return role === this.constants.user_role_enum.admin;
    },
    is_moderator: function(role) {
        return role === this.constants.user_role_enum.admin
            || role === this.constants.user_role_enum.moderator;
    },
    is_user: function(role) {
        return role === this.constants.user_role_enum.admin
            || role === this.constants.user_role_enum.moderator
            || role === this.constants.user_role_enum.user;
    },
    stop_propagation: e => e.stopPropagation(),
    long_date: function(d) {
        var date = new Date(d);
        return date.toDateString() + ' ' + date.toLocaleTimeString();
    },
    to_array: to_array,
    equal: (a, b) => a === b,
    first_defined: (a, b) => a || b,
};
</script>
